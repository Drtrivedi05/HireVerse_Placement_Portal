  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TNP Member Profile | HireVerse</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
      body { background: #f4f6f8; }
      .sidebar { min-height: 100vh; background: #fff; box-shadow: 2px 0 8px rgba(0,0,0,0.04); width: 240px; position: fixed; top: 0; left: 0; z-index: 1000; }
      .sidebar .nav-link { color: #007bff; margin-bottom: 1rem; font-weight: 500; font-size: 1.1rem; display: flex; align-items: center; gap: 0.5rem; border-radius: 8px; padding: 0.75rem 1rem; transition: background 0.2s; }
      .sidebar .nav-link.active, .sidebar .nav-link:hover { background: #e9f5ff; color: #0056b3; }
      .sidebar h2 { color: #007bff; font-weight: 700; font-size: 1.7rem; margin-bottom: 2rem; }
      .profile-container { max-width: 600px; margin: 3rem auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.08); padding: 2.5rem 2rem; }
      .profile-header { display: flex; align-items: center; gap: 1.5rem; margin-bottom: 2rem; }
      .profile-avatar { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; box-shadow: 0 2px 8px rgba(0,0,0,0.12); }
      .profile-title { font-size: 2rem; font-weight: 700; color: #007bff; }
      .profile-details { margin-bottom: 2rem; }
      .profile-details dt { font-weight: 600; color: #007bff; }
      .profile-details dd { margin-bottom: 1rem; color: #333; }
      .profile-actions { text-align: right; }
    </style>
  </head>
  <body>

    <!-- Sidebar -->
  <div class="sidebar d-flex flex-column justify-content-between"
     style="
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        width: 240px;
        background: #ffffff;
        box-shadow: 2px 0 8px rgba(0,0,0,0.05);
        padding: 20px 0;
        z-index: 1000;
     ">

  <!-- Logo Section -->
  <div style="text-align: center; margin-bottom: 20px;">
    {% load static %}
    <img src="{% static 'assets/logo_main.png' %}" 
         alt="HireVerse Logo" 
         style="width: 180px; height: auto; object-fit: contain;">
  </div>

  <!-- Navigation Links -->
  <nav class="nav flex-column" style="padding: 0 15px; flex-grow: 1;">
    
    <a class="nav-link" href="/tnpDashboard"
       style="color: #007bff; font-weight: 500;
              font-size: 1.05rem; margin-bottom: 12px; padding: 10px 12px;
              border-radius: 8px; display: flex; align-items: center; 
              gap: 8px; text-decoration: none; transition: 0.2s;">
      <i class="bi bi-speedometer2 me-2"></i> TNP Dashboard
    </a>

    <a class="nav-link active" href="/tnpProfile"
       style="background: #e9f5ff; color: #0056b3; font-weight: 600; font-size: 1.05rem;
              margin-bottom: 12px; padding: 10px 12px; border-radius: 8px;
              display: flex; align-items: center; gap: 8px; text-decoration: none;
              transition: 0.2s;"
       onmouseover="this.style.backgroundColor='#e9f5ff'; this.style.color='#0056b3';"
       onmouseout="this.style.backgroundColor='transparent'; this.style.color='#007bff';">
      <i class="bi bi-person-circle me-2"></i> Profile
    </a>

    <a class="nav-link" href="/tnpAddMember"
       style="color: #007bff; font-weight: 500; font-size: 1.05rem;
              margin-bottom: 12px; padding: 10px 12px; border-radius: 8px;
              display: flex; align-items: center; gap: 8px; text-decoration: none;
              transition: 0.2s;"
       onmouseover="this.style.backgroundColor='#e9f5ff'; this.style.color='#0056b3';"
       onmouseout="this.style.backgroundColor='transparent'; this.style.color='#007bff';">
      <i class="bi bi-person-plus me-2"></i> Add Members
    </a>

    <a class="nav-link" href="/tnpViewData"
       style="color: #007bff; font-weight: 500; font-size: 1.05rem;
              margin-bottom: 12px; padding: 10px 12px; border-radius: 8px;
              display: flex; align-items: center; gap: 8px; text-decoration: none;
              transition: 0.2s;"
       onmouseover="this.style.backgroundColor='#e9f5ff'; this.style.color='#0056b3';"
       onmouseout="this.style.backgroundColor='transparent'; this.style.color='#007bff';">
      <i class="bi bi-eye me-2"></i> View Data
    </a>

    <a class="nav-link" href="/tnpReport"
       style="color: #007bff; font-weight: 500; font-size: 1.05rem;
              margin-bottom: 12px; padding: 10px 12px; border-radius: 8px;
              display: flex; align-items: center; gap: 8px; text-decoration: none;
              transition: 0.2s;"
       onmouseover="this.style.backgroundColor='#e9f5ff'; this.style.color='#0056b3';"
       onmouseout="this.style.backgroundColor='transparent'; this.style.color='#007bff';">
      <i class="bi bi-bar-chart me-2"></i> Reports
    </a>
  </nav>

  <!-- Logout Button -->
  <a class="nav-link" href="{% url 'logout' %}"
     style="
        color: #dc3545; 
        font-weight: 600; 
        font-size: 1.05rem; 
        padding: 10px 12px; 
        border-radius: 8px; 
        display: flex; align-items: center; gap: 8px;
        text-decoration: none; 
        transition: 0.2s; 
        border-top: 1px solid #f0f0f0; 
        justify-content: center;
        margin-top: auto;
     "
     onmouseover="this.style.backgroundColor='#ffe6e9'; this.style.color='#b02a37';"
     onmouseout="this.style.backgroundColor='transparent'; this.style.color='#dc3545';">
    <i class="bi bi-box-arrow-right me-2"></i> Logout
  </a>

</div>

    <!-- Personal Information Card -->
    <div class="profile-container" id="personalInfoCard">
      <!-- Personal Info Messages -->
      <div id="personalMessages">
        {% for message in messages %}
          {% if 'personal' in message.tags %}
            <div class="alert alert-{{ message.level_tag }} alert-dismissible fade show py-1 px-2 small" role="alert">
              {{ message }}
              <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <div class="d-flex align-items-center mb-4">
        <div class="me-4 position-relative">
          {% if tnp.TNP_PROFILE_PHOTO %}
            <img src="{{ tnp.TNP_PROFILE_PHOTO.url }}" alt="Profile Photo" id="profilePhoto" class="profile-avatar" style="border: 3px solid #007bff;">
          {% else %}
            <img src="{% static 'assets/profile.jpeg' %}" alt="Profile Photo" id="profilePhoto" class="profile-avatar" style="border: 3px solid #007bff;">
          {% endif %}
          <input type="file" id="photoInput" name="TNP_PROFILE_PHOTO" accept="image/*" style="display:none;">
          <button class="btn btn-sm btn-light position-absolute bottom-0 end-0 border" id="editPhotoBtn" title="Change Photo" style="border-radius:50%;"><i class="bi bi-camera"></i></button>
        </div>
        <div>
          <h3 id="displayFullName" class="mb-1">{{ tnp.TNP_NAME }}</h3>
          <div class="text-muted" id="displayRole">{{ tnp.ROLE }}</div>
        </div>
      </div>

      <dl class="row mb-0" id="personalInfoDisplay">
        <dt class="col-sm-5">Date of Birth</dt>
        <dd class="col-sm-7" id="displayDob">{{ tnp.TNP_DATE_OF_BIRTH }}</dd>

        <dt class="col-sm-5">Contact Number</dt>
        <dd class="col-sm-7" id="displayContact">{{ tnp.TNP_PHONE_NO }}</dd>

        <dt class="col-sm-5">Email Address</dt>
        <dd class="col-sm-7" id="displayEmail">{{ tnp.TNP_EMAIL }}</dd>

        <dt class="col-sm-5">Permanent Address</dt>
        <dd class="col-sm-7" id="displayPermanent">{{ tnp.TNP_PERMANENT_ADDRESS }}</dd>

        <dt class="col-sm-5">Current Address</dt>
        <dd class="col-sm-7" id="displayCurrent">{{ tnp.TNP_CURRENT_ADDRESS }}</dd>

        <dt class="col-sm-5">College</dt>
        <dd class="col-sm-7" id="displayCollege">
          {% if tnp.COLLEGE %}
            {{ tnp.COLLEGE.COLLEGE_NAME }}
          {% else %}
            Not Assigned
          {% endif %}
        </dd>
      </dl>

      <form id="personalInfoForm" method="POST" enctype="multipart/form-data" style="display:none;">
        {% csrf_token %}
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label">Full Name</label>
            <input type="text" class="form-control" id="fullNameInput" name="full_name" value="{{ tnp.TNP_NAME }}">
          </div>
          <div class="col-6">
            <label class="form-label">Date of Birth</label>
            <input type="date" class="form-control" id="dobInput" name="dob" value="{{ tnp.TNP_DATE_OF_BIRTH }}">
          </div>
          <div class="col-6">
            <label class="form-label">Contact Number</label>
            <input type="tel" max="10" min="10" class="form-control" id="contactInput" name="contact" value="{{ tnp.TNP_PHONE_NO }}">
          </div>
          <div class="col-12">
            <label class="form-label">Email Address</label>
            <input type="email" class="form-control" id="emailInput" name="email" value="{{ tnp.TNP_EMAIL }}">
          </div>
          <div class="col-12">
            <label class="form-label">Permanent Address</label>
            <input type="text" class="form-control" id="permanentInput" name="permanent" value="{{ tnp.TNP_PERMANENT_ADDRESS }}">
          </div>
          <div class="col-12">
            <label class="form-label">Current Address</label>
            <input type="text" class="form-control" id="currentInput" name="current" value="{{ tnp.TNP_CURRENT_ADDRESS }}">
          </div>
          <div class="col-12">
            <label class="form-label">College</label>
            <input type="text" class="form-control" id="collegeInput" name="college" value="
            {% if tnp.COLLEGE %}
              {{ tnp.COLLEGE.COLLEGE_NAME }}
            {% else %}
              Not Assigned
            {% endif %}">
          </div>
          <div class="col-12">
            <label class="form-label">Profile Photo</label>
            <input type="file" id="photoInput" name="TNP_PROFILE_PHOTO" accept="image/*">
          </div>
        </div>
        <div class="mt-3 text-end">
          <button type="button" class="btn btn-secondary me-2" id="cancelPersonalBtn">Cancel</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>

      <div class="text-end mt-3">
        <button class="btn btn-outline-primary" id="editPersonalBtn"><i class="bi bi-pencil"></i> Edit</button>
      </div>
    </div>

    <!-- Contact & Social Links Card -->
    <div class="profile-container mt-4" id="contactSocialCard">
      <!-- Social Links Messages -->
      <div id="socialMessages">
        {% for message in messages %}
          {% if 'social' in message.tags %}
            <div class="alert alert-{{ message.level_tag }} alert-dismissible fade show py-1 px-2 small" role="alert">
              {{ message }}
              <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endif %}
        {% endfor %}
      </div>

      <h4 class="mb-3" style="color:#007bff;">Contact & Social Links</h4>
      <dl class="row mb-0" id="contactSocialDisplay">
        <dt class="col-sm-5">LinkedIn</dt>
        <dd class="col-sm-7">{{ tnp.TNP_LINKEDIN_URL }}</dd>

        <dt class="col-sm-5">GitHub</dt>
        <dd class="col-sm-7">{{ tnp.TNP_GITHUB_LINK }}</dd>

        <dt class="col-sm-5">Personal Website / Portfolio</dt>
        <dd class="col-sm-7">{{ tnp.TNP_PERSONAL_WEBSITE_PORTFOLIO }}</dd>
      </dl>

      <form id="contactSocialForm" method="POST" style="display:none;">
        {% csrf_token %}
        <div class="mb-3">
          <label for="linkedin" class="form-label">LinkedIn</label>
          <input type="url" class="form-control" id="linkedin" name="linkedin" placeholder="LinkedIn profile URL" value="{{ tnp.TNP_LINKEDIN_URL }}">
        </div>
        <div class="mb-3">
          <label for="github" class="form-label">GitHub</label>
          <input type="url" class="form-control" id="github" name="github" placeholder="GitHub profile URL" value="{{ tnp.TNP_GITHUB_LINK }}">
        </div>
        <div class="mb-3">
          <label for="website" class="form-label">Personal Website / Portfolio</label>
          <input type="url" class="form-control" id="website" name="website" placeholder="Website or portfolio URL" value="{{ tnp.TNP_PERSONAL_WEBSITE_PORTFOLIO }}">
        </div>
        <div class="text-end">
          <button type="button" class="btn btn-secondary me-2" id="cancelContactSocialBtn">Cancel</button>
          <button type="submit" class="btn btn-primary">Save</button>
        </div>
      </form>
      <div class="text-end mt-3">
        <button class="btn btn-outline-primary" id="editContactSocialBtn"><i class="bi bi-pencil"></i> Edit</button>
      </div>
    </div>

    <!-- Account Settings Card -->
    <div class="profile-container mt-4" id="accountSettingsCard">
      <h4 class="mb-3" style="color:#007bff;">Account Settings</h4>
      <!-- Password Messages -->
      <div id="passwordMessages" class="mb-2">
        {% for message in messages %}
          {% if 'password' in message.tags %}
            <div class="alert alert-{{ message.level_tag }} alert-dismissible fade show m-0" role="alert" style="font-size: 0.85rem;">
              {{ message }}
              <button type="button" class="btn-close btn-close-sm" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <form id="changePasswordForm" method="POST">
        {% csrf_token %}
        <div class="mb-3">
          <label for="oldPassword" class="form-label">Old Password</label>
          <input type="password" class="form-control" id="oldPassword" name="old_password" placeholder="Enter old password" required>
        </div>
        <div class="mb-3">
          <label for="newPassword" class="form-label">New Password</label>
          <input type="password" class="form-control" id="newPassword" name="new_password" placeholder="Enter new password" required>
        </div>
        <div class="mb-3">
          <label for="confirmPassword" class="form-label">Confirm Password</label>
          <input type="password" class="form-control" id="confirmPassword" name="confirm_password" placeholder="Confirm new password" required>
        </div>
        <button type="submit" class="btn btn-primary w-100">Change Password</button>
      </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    {% load static %}
    <script src="{% static 'main.js' %}"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const editPersonalBtn = document.getElementById('editPersonalBtn');
        const personalInfoForm = document.getElementById('personalInfoForm');
        const personalInfoDisplay = document.getElementById('personalInfoDisplay');
        const cancelPersonalBtn = document.getElementById('cancelPersonalBtn');
        editPersonalBtn.addEventListener('click', () => {
          personalInfoForm.style.display = '';
          personalInfoDisplay.style.display = 'none';
          editPersonalBtn.style.display = 'none';
        });
        cancelPersonalBtn.addEventListener('click', () => {
          personalInfoForm.style.display = 'none';
          personalInfoDisplay.style.display = '';
          editPersonalBtn.style.display = '';
        });

        const editContactSocialBtn = document.getElementById('editContactSocialBtn');
        const contactSocialForm = document.getElementById('contactSocialForm');
        const contactSocialDisplay = document.getElementById('contactSocialDisplay');
        const cancelContactSocialBtn = document.getElementById('cancelContactSocialBtn');
        editContactSocialBtn.addEventListener('click', () => {
          contactSocialForm.style.display = 'flex';
          contactSocialForm.style.flexDirection = 'column';
          contactSocialForm.style.width = '100%';
          contactSocialDisplay.style.display = 'none';
          editContactSocialBtn.style.display = 'none';
        });
        cancelContactSocialBtn.addEventListener('click', () => {
          contactSocialForm.style.display = 'none';
          contactSocialDisplay.style.display = 'block';
          editContactSocialBtn.style.display = 'block';
        });

        const profilePhoto = document.getElementById('profilePhoto');
        const editPhotoBtn = document.getElementById('editPhotoBtn');
        const photoInput = document.getElementById('photoInput');
        editPhotoBtn.addEventListener('click', () => photoInput.click());
        photoInput.addEventListener('change', function() {
          const file = photoInput.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(e) { profilePhoto.src = e.target.result; }
            reader.readAsDataURL(file);
          }
        });
      });
    </script>
  </body>
  </html>
